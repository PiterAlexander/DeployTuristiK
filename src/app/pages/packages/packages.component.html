<!-- eslint-disable @angular-eslint/template/eqeqeq -->
<ng-container *ngIf="role==='Cliente' || role=== undefined">
    <div style="width: 90%; margin-left: auto; margin-right: auto;">
        <div class="text-initial">
            <p class="title">Explora nuestros <span class="span-title">paquetes</span></p>
        </div>
    </div>
    <div style="width: 90%; margin-left: auto; margin-right: auto;" class="grid">
        <div class="col-12">
            <div class="card">
                <p-dataView #dv [value]="arrayPackagesClient" [paginator]="true" [rows]="9" filterBy="name" [sortField]="sortField" [sortOrder]="sortOrder" layout="grid">
                    <ng-template pTemplate="header">
                        <div class="flex flex-column md:flex-row md:justify-content-between gap-2">
                            <span class="p-input-icon-left">
                                <i class="pi pi-search"></i>
                                <input type="search" pInputText placeholder="Busca por el nombre..."  (input)="onFilter(dv, $event)">
                            </span>	
                            <p-dataViewLayoutOptions></p-dataViewLayoutOptions>
                        </div>
                    </ng-template>
    
                    <ng-template let-package pTemplate="listItem">
                        <div class="col-12">
                            <div class="flex flex-column md:flex-row align-items-center p-3 w-full ">
                                <img src="https://img.freepik.com/vector-gratis/ilustracion-arte-linea-dibujada-mano_23-2149279750.jpg" class="my-4 md:my-0 w-9 md:w-10rem shadow-2 mr-5"/>
                                <div class="flex-1 flex flex-column align-items-center text-center md:text-left">
                                    <div class="font-bold text-2xl p-2">{{package.name}}</div>
                                    <div class="mb-2"><i class="pi pi-map-marker m-1"></i>{{package.destination}}</div>
                                    <div class="mb-2"><i class="pi pi-building m-1"></i>{{package.hotel}}</div>
                                    <div class="flex align-items-center mt-2">
                                        <small class="font-semibold m-2" pTooltip="Fecha de salida" tooltipPosition="bottom">{{package.departureDate | date}}</small><span>-</span>
                                        <small class="font-semibold m-2" pTooltip="Fecha de regreso" tooltipPosition="bottom">{{package.arrivalDate | date}}</small>
                                    </div>
                                </div>
                                <div class="flex flex-row md:flex-column justify-content-between w-full md:w-auto align-items-center md:align-items-end mt-5 md:mt-0">
                                    <small [class]="'package-badge quotas-' + quotas(package.availableQuotas)" class="mb-3" >{{package.availableQuotas > 10 ? "Con cupos" : "Agotandose"}}</small>
                                    <span class="text-2xl font-semibold mb-2 align-self-center md:align-self-end">{{package.price | currency: 'USD':'symbol' }}</span>
                                    <button icon="pi pi-eye" pButton type="button" (click)="verDetalles(package.packageId)" label="Ver informacion" class="p-button-outlined  p-button-sm"></button>
                                </div>
                            </div>
                        </div>
                    </ng-template>
    
                    <ng-template let-package pTemplate="gridItem">
                        <div class="col-12 md:col-4 ">
                            <div class="card m-3 layout-light p-3 hoverCard" (click)="verDetalles(package.packageId)">
                                <div class="flex flex-wrap gap-2 align-items-center justify-content-between mb-2">
                                    <div class="flex align-items-center">
                                        <i class="pi pi-map-marker mr-2"></i>
                                        <span class="font-semibold">{{package.destination}}</span>
                                    </div>
                                    <small [class]="'package-badge quotas-' + quotas(package.availableQuotas)">{{package.availableQuotas > 10 ? "Disponible" : "Pocos cupos"}}</small>
                                </div>
                                <div class="flex flex-column align-items-center text-center mb-3">
                                    <img src="https://img.freepik.com/vector-gratis/ilustracion-arte-linea-dibujada-mano_23-2149279750.jpg" class="w-6 shadow-2 my-3 mx-0"/>
                                    <div class="text-2xl font-bold">{{package.name}}</div>
                                    <div class="flex align-items-center mt-2">
                                        <small class="font-semibold m-2" pTooltip="Fecha de salida" tooltipPosition="bottom" style="cursor: pointer;">{{package.departureDate | date}}</small><span>-</span>
                                        <small class="font-semibold m-2" pTooltip="Fecha de regreso" tooltipPosition="bottom" style="cursor: pointer;">{{package.arrivalDate | date}}</small>
                                    </div>
                                </div>
                                <div class="flex align-items-center justify-content-center">
                                    <span class="text-2xl font-semibold">{{package.price | currency: 'USD':'symbol' }} </span>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </p-dataView>
            </div>
        </div>
        <!-- <div class="container px-4 px-lg-5 mt-5">
            <div class="row gx-4 gx-lg-5 row-cols-1 row-cols-md-3 row-cols-xl-3 justify-content-center">
                <div class="col-4 p-3 mb-2" *ngFor="let pack of filteredPackagesList">
                    <div class="card h-100 hoverCard" style="cursor: pointer;">
                        <div class="card-header p-0">
                            <div class="d-flex">
                                <img class="card-img-top"
                                    src="https://st2.depositphotos.com/3725083/5485/i/600/depositphotos_54856347-stock-photo-travel-the-world-monument-concept.jpg"
                                    alt="..." />
                                <span
                                    class="position-absolute style-edit translate-middle bg-primary border border-light rounded-circle">
                                    <span class="visually-hidden">{{calculateDays(pack.departureDate,
                                        pack.arrivalDate)}}
                                        dias / {{calculateDays(pack.departureDate, pack.arrivalDate)-1}} noches</span>
                                </span>
                            </div>
                        </div>
                        <div class="card-body pl-4 pr-4 pb-1">
                            <div class="text-left small mb-1">
                                <h5 class="fw-bolder">{{pack.name}}</h5>
                                <p class="text-card">Desde {{pack.departureDate | date}} hasta {{pack.arrivalDate |
                                    date}}
                                </p>
                                <i *ngIf="pack.transport=== 1" class="p-1 fa fa-plane"></i> <i
                                    *ngIf="pack.transport=== 2" class="p-1 fa fa-bus"></i>
                                <span class="m-1" *ngIf="pack.transport=== 1">Aereo</span>
                                <span class="m-1" *ngIf="pack.transport=== 2">Terrestre</span>
                                <i class="p-1 fas fa-hotel"></i>
                                <span class="m-1">{{pack.hotel}}</span>
                            </div>
                            <div class="text-left small">
                                <i class="p-1 	fas fa-plane-departure"></i>
                                <span class="m-1">Partiendo desde {{pack.departurePoint}}</span>
                            </div>
                            <hr class="solid">
                            <div class="text-left small">
                                <span class="m-1">Precio por persona</span>
                                <p class="price-text p-1 m-0">{{pack.price | currency:'COP '}}</p>
                            </div>
                        </div>
                        <div class="d-flex justify-content-end card-footer pt-0 mb-1 border-top-0 bg-transparent">
                            <button type="button" (click)="reserve(pack)"
                                class="btn btn-primary col-6">Reservar</button>
                        </div>
                    </div>
                </div>
            </div>
        </div> -->
    </div>
</ng-container>



<div *ngIf="role!=='Cliente' && role !== undefined" class="p-5">
    <div class="col-12">
        <div class="card px-6 py-6 p-4" style="border-radius: 15px;">
            <p-table #dt [value]="packagesList" [rows]="5" [showCurrentPageReport]="true" [rowsPerPageOptions]="[5, 10]"
                [loading]="loading" [paginator]="true"
                currentPageReportTemplate="Desde {first} hasta {last} de {totalRecords} paquetes"
                [globalFilterFields]="['name', 'destination', 'departureDate', 'arrivalDate', 'availableQuotas', 'price', 'status']">
                <ng-template pTemplate="caption" class="p-grid">
                    <div class="custom-flex-container">
                        <div class="custom-flex-item-left">
                            <span class="mt-2 md:mt-0 p-input-icon-right">
                                <i class="pi pi-search"></i>
                                <input pInputText  (input)="dt.filterGlobal($event.target.value, 'contains')" type="text" placeholder="Buscar..." />
                            </span>
                        </div>
                        <div class="custom-flex-item-right">
                            <button pButton type="button" label="Registrar paquete" (click)="show()"
                                class="p-button-outlined"><i class="pi pi-plus"
                                    style="margin-left: 5px; margin-right: 9px;"></i></button>
                        </div>
                    </div>
                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th style="min-width: 15rem">
                            <div class="flex justify-content-left align-items-left">
                                Nombre
                            </div>
                        </th>
                        <th style="min-width: 10rem">
                            <div class="flex justify-content-left align-items-left">
                                Fechas
                            </div>
                        </th>
                        <th style="min-width: 10rem">
                            <div class="flex justify-content-left align-items-left">
                                Cupos disponibles
                            </div>
                        </th>
                        <th style="width: 10rem">
                            <div class="flex justify-content-left align-items-left">
                                Precio
                            </div>
                        </th>
                        <th style="min-width: 10rem">
                            <div class="flex justify-content-left align-items-left">
                                Estado
                            </div>
                        </th>
                        <th style="width: 10rem">
                            <div class="flex justify-content-left align-items-left">
                                Acciones
                            </div>
                        </th>

                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-package>
                    <tr>
                        <td>
                            {{ package.name }}
                        </td>
                        <td>
                            <span pTooltip="Fecha de salida">
                                {{ package.departureDate | date: 'MM/dd/yyyy' }}
                            </span>
                            <br>
                            <span pTooltip="Fecha de regreso">
                                {{ package.arrivalDate | date: 'MM/dd/yyyy' }}
                            </span>
                        </td>
                        <td>
                            {{ package.availableQuotas }}
                        </td>
                        <td>
                            {{ package.price }}
                        </td>
                        <td class="text-center">


                            <div *ngIf="package.status == true">
                                <p-inputSwitch  (click)="disablePackage(package)" [(ngModel)]="checked2"  pTooltip="Activo" tooltipPosition="bottom"></p-inputSwitch>

                            </div>
                            <div *ngIf="package.status == false">
                                <p-inputSwitch  (click)="disablePackage(package)"pTooltip="Inactivo" tooltipPosition="bottom"></p-inputSwitch>

                            </div>
                        </td>
                        <td class="text-center p-1">
                            <button pButton type="button" icon="pi pi-pencil"
                                class="p-button-outlined p-button-warning p-button-rounded m-1" (click)="openEditPackageModal(package)" pTooltip="Editar"
                                tooltipPosition="bottom"></button>
                            <button pButton type="button" icon="pi pi-info-circle"
                                class="p-button-outlined p-button-rounded m-1" pTooltip="Ver detalles"  (click)="modalShowDetailsPackage(package)"
                                tooltipPosition="bottom"></button>

                        </td>

                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="9">No se encontraron paquetes</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </div>
</div>
